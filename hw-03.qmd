---
title: "HW 03"
author: "Cat Xia"
format:
  html:
    embed-resources: true
toc: true
---

## 1 - Du Bois challenge.

```{r loading packages}
#| label: loading packages

if (!require("pacman"))
  install.packages("pacman")

pacman::p_load(tidyverse, here, glue, scales, janitor, forcats)

ggplot2::theme_set(ggplot2::theme_minimal())
options(width = 65)
knitr::opts_chunk$set(
  fig.width = 7,
  fig.asp = 0.618,
  fig.retina = 3,
  fig.align = "center",
  api = 300
)

```

```{r load data}
#| label: load data

income <- read.csv(here("data", "income.csv"))
income <- clean_names(income)
glimpse(income)
```
```{r du bois data wrangling}
#| label: du bois data wrangling

#pivots the table so that it creates two new columns, one for spending type and one for the amount
income_clean <- income|>
  pivot_longer(cols = -c(class, average_income), names_to = "spending_type", values_to = "amount")

income_clean$class <- fct_relevel(
  income_clean$class,
  "$1000 AND OVER", 
  "$750-1000", 
  "$500-750", 
  "$400-500", 
  "$300-400", 
  "$200-300", 
  "$100-200"
)

income_clean$spending_type <- fct_relevel(
  income_clean$spending_type,
  "other", "tax", "clothes", "food", "rent"
)
```


```{r du bois recreation}
#| label: du bois recreation

income_clean |>
  ggplot(aes(x = class, y = amount, fill = spending_type, order = spending_type)) +
  geom_bar(stat = "identity", position = "fill") +
  coord_flip() +
  scale_fill_manual(values = c("grey","lightblue","pink", "#966FD6", "grey10")) 

```


## 2 - COVID survey - interpret

```{r}
#| label: label-me-2

```

## 3 - COVID survey - reconstruct


## 4 - COVID survey - re-reconstruct

## 5 - COVID survey - another view
